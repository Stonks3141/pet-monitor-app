import{S as wt,i as Lt,s as It,k as h,q as k,a as m,l as v,m as d,r as O,h as u,c as E,n as c,J as Ce,b as pe,E as r,K as G,L as be,M as j,B as Ge,N as we,O as Nt,u as Qe,P as Le,w as Pt,x as At,y as Bt,f as Dt,t as jt,z as yt}from"../../../chunks/index-a4c379a0.js";import{g as St}from"../../../chunks/navigation-e0c39cd1.js";const Ut=()=>{const t=document.cookie.match(new RegExp("(^| )token=([^;]+)"));return t?t[2]:null},Vt=()=>{document.cookie="token=; Max-Age=0"};function dt(t,e,o){const a=t.slice();return a[26]=e[o],a[27]=e,a[28]=o,a}function bt(t,e,o){const a=t.slice();return a[29]=e[o],a}function pt(t,e,o){const a=t.slice();return a[32]=e[o].resolution,a}function gt(t,e,o){const a=t.slice();return a[35]=e[o],a}function mt(t,e,o){const a=t.slice();return a[38]=e[o],a}function Et(t){let e,o=t[38]+"",a,s;return{c(){e=h("option"),a=k(o),this.h()},l(i){e=v(i,"OPTION",{});var _=d(e);a=O(_,o),_.forEach(u),this.h()},h(){e.__value=s=t[38],e.value=e.__value},m(i,_){pe(i,e,_),r(e,a)},p(i,_){_[0]&2&&o!==(o=i[38]+"")&&Qe(a,o),_[0]&2&&s!==(s=i[38])&&(e.__value=s,e.value=e.__value)},d(i){i&&u(e)}}}function kt(t){let e,o=t[35]+"",a,s;return{c(){e=h("option"),a=k(o),this.h()},l(i){e=v(i,"OPTION",{});var _=d(e);a=O(_,o),_.forEach(u),this.h()},h(){e.__value=s=t[35],e.value=e.__value},m(i,_){pe(i,e,_),r(e,a)},p(i,_){_[0]&3&&o!==(o=i[35]+"")&&Qe(a,o),_[0]&3&&s!==(s=i[35])&&(e.__value=s,e.value=e.__value)},d(i){i&&u(e)}}}function Ot(t){let e,o=`${t[32][0]}x${t[32][1]}`,a,s;return{c(){e=h("option"),a=k(o),this.h()},l(i){e=v(i,"OPTION",{});var _=d(e);a=O(_,o),_.forEach(u),this.h()},h(){e.__value=s=t[32],e.value=e.__value},m(i,_){pe(i,e,_),r(e,a)},p(i,_){_[0]&3&&o!==(o=`${i[32][0]}x${i[32][1]}`)&&Qe(a,o),_[0]&3&&s!==(s=i[32])&&(e.__value=s,e.value=e.__value)},d(i){i&&u(e)}}}function Tt(t){let e,o=t[29][1]/t[29][0]+"",a;return{c(){e=h("option"),a=k(o),this.h()},l(s){e=v(s,"OPTION",{});var i=d(e);a=O(i,o),i.forEach(u),this.h()},h(){e.__value=t[29],e.value=e.__value},m(s,i){pe(s,e,i),r(e,a)},p:Ge,d(s){s&&u(e)}}}function Ct(t){let e,o,a,s,i,_,y,U,f,F,R,z;function L(...I){return t[19](t[26],...I)}function ne(){t[20].call(i,t[26])}function H(...I){return t[21](t[26],...I)}return{c(){e=h("div"),o=h("input"),s=m(),i=h("input"),_=m(),y=h("button"),U=h("span"),f=k("remove"),F=m(),this.h()},l(I){e=v(I,"DIV",{class:!0});var C=d(e);o=v(C,"INPUT",{type:!0,class:!0}),s=E(C),i=v(C,"INPUT",{type:!0,class:!0}),_=E(C),y=v(C,"BUTTON",{class:!0});var w=d(y);U=v(w,"SPAN",{class:!0});var Z=d(U);f=O(Z,"remove"),Z.forEach(u),w.forEach(u),F=E(C),C.forEach(u),this.h()},h(){c(o,"type","text"),c(o,"class","input input-bordered bg-base-200 w-full"),o.value=a=t[26],c(i,"type","text"),c(i,"class","input input-bordered bg-base-200 w-full"),c(U,"class","material-icons"),c(y,"class","btn btn-ghost w-fit mr-2"),c(e,"class","flex flex-row gap-2")},m(I,C){pe(I,e,C),r(e,o),r(e,s),r(e,i),be(i,t[0].v4l2Controls[t[26]]),r(e,_),r(e,y),r(y,U),r(U,f),r(e,F),R||(z=[j(o,"change",L),j(i,"input",ne),j(y,"click",H)],R=!0)},p(I,C){t=I,C[0]&3&&a!==(a=t[26])&&o.value!==a&&(o.value=a),C[0]&3&&i.value!==t[0].v4l2Controls[t[26]]&&be(i,t[0].v4l2Controls[t[26]])},d(I){I&&u(e),R=!1,Nt(z)}}}function Ft(t){let e,o,a,s,i,_,y,U,f,F,R,z,L,ne,H,I,C,w,Z,Q,ge,me,V,Ee,W,ke,Oe,M,b,q,Ne,Se,J,$,Pe,x,Ae,ee,Be,te,De,je,ae,ye,Ue,le,Ve,K,X,Fe,Y,Re,se,Me,qe,oe,re,ce,Je,ze,ie,He,Ke,We,ue=Object.keys(t[1]),S=[];for(let n=0;n<ue.length;n+=1)S[n]=Et(mt(t,ue,n));let fe=Object.keys(t[1][t[0].device]),P=[];for(let n=0;n<fe.length;n+=1)P[n]=kt(gt(t,fe,n));let _e=t[1][t[0].device][t[0].format],A=[];for(let n=0;n<_e.length;n+=1)A[n]=Ot(pt(t,_e,n));let he=t[8](),B=[];for(let n=0;n<he.length;n+=1)B[n]=Tt(bt(t,he,n));let ve=Object.keys(t[0].v4l2Controls),D=[];for(let n=0;n<ve.length;n+=1)D[n]=Ct(dt(t,ve,n));return{c(){e=h("div"),o=h("div"),a=h("h2"),s=k("Settings"),i=m(),_=h("button"),y=k("Log out"),U=m(),f=h("form"),F=h("label"),R=k("Device"),z=m(),L=h("select");for(let n=0;n<S.length;n+=1)S[n].c();ne=m(),H=h("label"),I=k("Format"),C=m(),w=h("select");for(let n=0;n<P.length;n+=1)P[n].c();Z=m(),Q=h("label"),ge=k("Resolution"),me=m(),V=h("select");for(let n=0;n<A.length;n+=1)A[n].c();Ee=m(),W=h("label"),ke=k("Framerate"),Oe=m(),M=h("select");for(let n=0;n<B.length;n+=1)B[n].c();b=m(),q=h("label"),Ne=k("Rotation"),Se=m(),J=h("select"),$=h("option"),Pe=k("0\xB0"),x=h("option"),Ae=k("90\xB0"),ee=h("option"),Be=k("180\xB0"),te=h("option"),De=k("270\xB0"),je=m(),ae=h("label"),ye=k("Additional V4L2 controls"),Ue=m(),le=h("div");for(let n=0;n<D.length;n+=1)D[n].c();Ve=m(),K=h("div"),X=h("input"),Fe=m(),Y=h("input"),Re=m(),se=h("button"),Me=k("Add"),qe=m(),oe=h("div"),re=h("button"),ce=h("a"),Je=k("Cancel"),ze=m(),ie=h("button"),He=k("Save"),this.h()},l(n){e=v(n,"DIV",{class:!0});var g=d(e);o=v(g,"DIV",{class:!0});var l=d(o);a=v(l,"H2",{class:!0});var N=d(a);s=O(N,"Settings"),N.forEach(u),i=E(l),_=v(l,"BUTTON",{class:!0});var Xe=d(_);y=O(Xe,"Log out"),Xe.forEach(u),l.forEach(u),U=E(g),f=v(g,"FORM",{class:!0});var p=d(f);F=v(p,"LABEL",{for:!0,class:!0});var Ye=d(F);R=O(Ye,"Device"),Ye.forEach(u),z=E(p),L=v(p,"SELECT",{id:!0,class:!0});var Ze=d(L);for(let T=0;T<S.length;T+=1)S[T].l(Ze);Ze.forEach(u),ne=E(p),H=v(p,"LABEL",{for:!0,class:!0});var $e=d(H);I=O($e,"Format"),$e.forEach(u),C=E(p),w=v(p,"SELECT",{id:!0,class:!0});var xe=d(w);for(let T=0;T<P.length;T+=1)P[T].l(xe);xe.forEach(u),Z=E(p),Q=v(p,"LABEL",{for:!0,class:!0});var et=d(Q);ge=O(et,"Resolution"),et.forEach(u),me=E(p),V=v(p,"SELECT",{id:!0,class:!0});var tt=d(V);for(let T=0;T<A.length;T+=1)A[T].l(tt);tt.forEach(u),Ee=E(p),W=v(p,"LABEL",{for:!0,class:!0});var lt=d(W);ke=O(lt,"Framerate"),lt.forEach(u),Oe=E(p),M=v(p,"SELECT",{id:!0,class:!0});var ot=d(M);for(let T=0;T<B.length;T+=1)B[T].l(ot);ot.forEach(u),b=E(p),q=v(p,"LABEL",{for:!0,class:!0});var nt=d(q);Ne=O(nt,"Rotation"),nt.forEach(u),Se=E(p),J=v(p,"SELECT",{id:!0,class:!0});var Te=d(J);$=v(Te,"OPTION",{});var at=d($);Pe=O(at,"0\xB0"),at.forEach(u),x=v(Te,"OPTION",{});var st=d(x);Ae=O(st,"90\xB0"),st.forEach(u),ee=v(Te,"OPTION",{});var rt=d(ee);Be=O(rt,"180\xB0"),rt.forEach(u),te=v(Te,"OPTION",{});var it=d(te);De=O(it,"270\xB0"),it.forEach(u),Te.forEach(u),je=E(p),ae=v(p,"LABEL",{for:!0,class:!0});var ct=d(ae);ye=O(ct,"Additional V4L2 controls"),ct.forEach(u),Ue=E(p),le=v(p,"DIV",{id:!0,class:!0});var ut=d(le);for(let T=0;T<D.length;T+=1)D[T].l(ut);ut.forEach(u),Ve=E(p),K=v(p,"DIV",{class:!0});var de=d(K);X=v(de,"INPUT",{type:!0,class:!0}),Fe=E(de),Y=v(de,"INPUT",{type:!0,class:!0}),Re=E(de),se=v(de,"BUTTON",{class:!0});var ft=d(se);Me=O(ft,"Add"),ft.forEach(u),de.forEach(u),qe=E(p),oe=v(p,"DIV",{class:!0});var Ie=d(oe);re=v(Ie,"BUTTON",{type:!0,class:!0});var _t=d(re);ce=v(_t,"A",{href:!0});var ht=d(ce);Je=O(ht,"Cancel"),ht.forEach(u),_t.forEach(u),ze=E(Ie),ie=v(Ie,"BUTTON",{type:!0,class:!0});var vt=d(ie);He=O(vt,"Save"),vt.forEach(u),Ie.forEach(u),p.forEach(u),g.forEach(u),this.h()},h(){c(a,"class","card-title"),c(_,"class","btn btn-ghost w-fit"),c(o,"class","flex flex-row justify-between gap-2 mx-8 mt-8"),c(F,"for","device"),c(F,"class","label"),c(L,"id","device"),c(L,"class","select bg-base-200 select-bordered"),t[0].device===void 0&&Ce(()=>t[11].call(L)),c(H,"for","format"),c(H,"class","label"),c(w,"id","format"),c(w,"class","select bg-base-200 select-bordered"),t[0].format===void 0&&Ce(()=>t[13].call(w)),c(Q,"for","resolution"),c(Q,"class","label"),c(V,"id","resolution"),c(V,"class","select bg-base-200 select-bordered"),t[0].resolution===void 0&&Ce(()=>t[15].call(V)),c(W,"for","interval"),c(W,"class","label"),c(M,"id","interval"),c(M,"class","select bg-base-200 select-bordered"),t[0].interval===void 0&&Ce(()=>t[17].call(M)),c(q,"for","rotation"),c(q,"class","label"),$.__value=0,$.value=$.__value,x.__value=90,x.value=x.__value,ee.__value=180,ee.value=ee.__value,te.__value=270,te.value=te.__value,c(J,"id","rotation"),c(J,"class","select bg-base-200 select-bordered"),t[0].rotation===void 0&&Ce(()=>t[18].call(J)),c(ae,"for","v4l2Controls"),c(ae,"class","label"),c(le,"id","v4l2Controls"),c(le,"class","flex flex-col gap-2"),c(X,"type","text"),c(X,"class","input input-bordered bg-base-200 w-full"),c(Y,"type","text"),c(Y,"class","input input-bordered bg-base-200 w-full"),c(se,"class","btn btn-ghost"),c(K,"class","flex flex-row gap-2"),c(ce,"href","/stream"),c(re,"type","button"),c(re,"class","btn btn-ghost w-fit"),c(ie,"type","submit"),c(ie,"class","btn btn-primary w-fit"),c(oe,"class","flex flex-row justify-between mt-4"),c(f,"class","form-control card-body"),c(e,"class","card h-fit w-full md:w-3/4 lg:w-1/2 bg-base-100")},m(n,g){pe(n,e,g),r(e,o),r(o,a),r(a,s),r(o,i),r(o,_),r(_,y),r(e,U),r(e,f),r(f,F),r(F,R),r(f,z),r(f,L);for(let l=0;l<S.length;l+=1)S[l].m(L,null);G(L,t[0].device),r(f,ne),r(f,H),r(H,I),r(f,C),r(f,w);for(let l=0;l<P.length;l+=1)P[l].m(w,null);G(w,t[0].format),r(f,Z),r(f,Q),r(Q,ge),r(f,me),r(f,V);for(let l=0;l<A.length;l+=1)A[l].m(V,null);G(V,t[0].resolution),r(f,Ee),r(f,W),r(W,ke),r(f,Oe),r(f,M);for(let l=0;l<B.length;l+=1)B[l].m(M,null);G(M,t[0].interval),r(f,b),r(f,q),r(q,Ne),r(f,Se),r(f,J),r(J,$),r($,Pe),r(J,x),r(x,Ae),r(J,ee),r(ee,Be),r(J,te),r(te,De),G(J,t[0].rotation),r(f,je),r(f,ae),r(ae,ye),r(f,Ue),r(f,le);for(let l=0;l<D.length;l+=1)D[l].m(le,null);r(f,Ve),r(f,K),r(K,X),be(X,t[3]),r(K,Fe),r(K,Y),be(Y,t[4]),r(K,Re),r(K,se),r(se,Me),r(f,qe),r(f,oe),r(oe,re),r(re,ce),r(ce,Je),r(oe,ze),r(oe,ie),r(ie,He),Ke||(We=[j(_,"click",t[10]),j(L,"change",t[11]),j(L,"change",t[12]),j(w,"change",t[13]),j(w,"change",t[14]),j(V,"change",t[15]),j(V,"change",t[16]),j(M,"change",t[17]),j(J,"change",t[18]),j(X,"input",t[22]),j(Y,"input",t[23]),j(se,"click",t[24]),j(f,"submit",t[25])],Ke=!0)},p(n,g){if(g[0]&2){ue=Object.keys(n[1]);let l;for(l=0;l<ue.length;l+=1){const N=mt(n,ue,l);S[l]?S[l].p(N,g):(S[l]=Et(N),S[l].c(),S[l].m(L,null))}for(;l<S.length;l+=1)S[l].d(1);S.length=ue.length}if(g[0]&3&&G(L,n[0].device),g[0]&3){fe=Object.keys(n[1][n[0].device]);let l;for(l=0;l<fe.length;l+=1){const N=gt(n,fe,l);P[l]?P[l].p(N,g):(P[l]=kt(N),P[l].c(),P[l].m(w,null))}for(;l<P.length;l+=1)P[l].d(1);P.length=fe.length}if(g[0]&3&&G(w,n[0].format),g[0]&3){_e=n[1][n[0].device][n[0].format];let l;for(l=0;l<_e.length;l+=1){const N=pt(n,_e,l);A[l]?A[l].p(N,g):(A[l]=Ot(N),A[l].c(),A[l].m(V,null))}for(;l<A.length;l+=1)A[l].d(1);A.length=_e.length}if(g[0]&3&&G(V,n[0].resolution),g[0]&256){he=n[8]();let l;for(l=0;l<he.length;l+=1){const N=bt(n,he,l);B[l]?B[l].p(N,g):(B[l]=Tt(N),B[l].c(),B[l].m(M,null))}for(;l<B.length;l+=1)B[l].d(1);B.length=he.length}if(g[0]&3&&G(M,n[0].interval),g[0]&3&&G(J,n[0].rotation),g[0]&513){ve=Object.keys(n[0].v4l2Controls);let l;for(l=0;l<ve.length;l+=1){const N=dt(n,ve,l);D[l]?D[l].p(N,g):(D[l]=Ct(N),D[l].c(),D[l].m(le,null))}for(;l<D.length;l+=1)D[l].d(1);D.length=ve.length}g[0]&8&&X.value!==n[3]&&be(X,n[3]),g[0]&16&&Y.value!==n[4]&&be(Y,n[4])},i:Ge,o:Ge,d(n){n&&u(e),we(S,n),we(P,n),we(A,n),we(B,n),we(D,n),Ke=!1,Nt(We)}}}function Rt(t,e,o){let{capabilities:a}=e,{config:s}=e,{onSubmit:i}=e;console.log(s);const _=()=>o(0,s.format=Object.keys(a[s.device])[0],s),y=()=>o(0,s.resolution=a[s.device][s.format][0].resolution,s),U=()=>o(0,s.interval=a[s.device][s.format].find(b=>b.resolution[0]===s.resolution[0]&&b.resolution[1]===s.resolution[1]).intervals[0],s),f=()=>a[s.device][s.format].find(b=>b.resolution[0]===s.resolution[0]&&b.resolution[1]===s.resolution[1]).intervals,F=(b,q)=>{o(0,s.v4l2Controls[b.target.value]=s.v4l2Controls[q],s),delete s.v4l2Controls[q]};let R="",z="";const L=()=>{Vt(),St("/login")};function ne(){s.device=Le(this),o(0,s),o(1,a)}const H=()=>{_(),y(),U()};function I(){s.format=Le(this),o(0,s),o(1,a)}const C=()=>{y(),U()};function w(){s.resolution=Le(this),o(0,s),o(1,a)}const Z=()=>{U()};function Q(){s.interval=Le(this),o(0,s),o(1,a)}function ge(){s.rotation=Le(this),o(0,s),o(1,a)}const me=(b,q)=>F(q,b);function V(b){s.v4l2Controls[b]=this.value,o(0,s),o(1,a)}const Ee=(b,q)=>{q.preventDefault(),delete s.v4l2Controls[b],o(0,s)};function W(){R=this.value,o(3,R)}function ke(){z=this.value,o(4,z)}const Oe=b=>{b.preventDefault(),R!=""&&z!=""&&(o(0,s.v4l2Controls[R]=z,s),o(3,R=""),o(4,z=""))},M=b=>{b.preventDefault(),i(s)};return t.$$set=b=>{"capabilities"in b&&o(1,a=b.capabilities),"config"in b&&o(0,s=b.config),"onSubmit"in b&&o(2,i=b.onSubmit)},[s,a,i,R,z,_,y,U,f,F,L,ne,H,I,C,w,Z,Q,ge,me,V,Ee,W,ke,Oe,M]}class Mt extends wt{constructor(e){super(),Lt(this,e,Rt,Ft,It,{capabilities:1,config:0,onSubmit:2},null,[-1,-1])}}function qt(t){let e,o;return e=new Mt({props:{capabilities:t[0].capabilities,config:t[0].config,onSubmit:t[1]}}),{c(){Pt(e.$$.fragment)},l(a){At(e.$$.fragment,a)},m(a,s){Bt(e,a,s),o=!0},p(a,[s]){const i={};s&1&&(i.capabilities=a[0].capabilities),s&1&&(i.config=a[0].config),e.$set(i)},i(a){o||(Dt(e.$$.fragment,a),o=!0)},o(a){jt(e.$$.fragment,a),o=!1},d(a){yt(e,a)}}}function Jt(t,e,o){let{data:a}=e;const s=i=>{fetch("/api/config",{method:"PUT",headers:{"content-type":"application/json","x-csrf-token":Ut()},body:JSON.stringify(i)}),St("/stream")};return t.$$set=i=>{"data"in i&&o(0,a=i.data)},[a,s]}class Kt extends wt{constructor(e){super(),Lt(this,e,Jt,qt,It,{data:0})}}export{Kt as default};
